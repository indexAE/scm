{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/indexae/Desktop/scm/scm/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regeneratorRuntime from \"C:/Users/indexae/Desktop/scm/scm/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"C:/Users/indexae/Desktop/scm/scm/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"C:/Users/indexae/Desktop/scm/scm/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.is-array.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { ref, onMounted } from 'vue';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { useSettingsStore } from '../stores/settings';\n\n// 用户列表数据\n\nexport default {\n  __name: 'UserManage',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var users = ref([]);\n    var allRoles = ref([]); // 所有角色列表\n    var selectedRoles = ref([]); // 选中的角色ID列表\n    var currentUserId = ref(null); // 当前操作的用户ID\n    var settingsStore = useSettingsStore();\n\n    // 对话框相关数据\n    var dialogVisible = ref(false);\n    var roleDialogVisible = ref(false);\n    var dialogTitle = ref('添加用户');\n    var userForm = ref({\n      id: null,\n      username: '',\n      password: '',\n      roles: [] // 添加角色字段\n    });\n\n    // 获取用户列表\n    var getUsers = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var res, data, usersWithRoles;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return fetch('http://127.0.0.1:8080/api/users', {\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 3:\n              res = _context2.sent;\n              _context2.next = 6;\n              return res.json();\n            case 6:\n              data = _context2.sent;\n              if (!(data.code === 0)) {\n                _context2.next = 15;\n                break;\n              }\n              _context2.next = 10;\n              return Promise.all(data.data.map(/*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user) {\n                  var rolesRes, rolesData, roles;\n                  return _regeneratorRuntime().wrap(function _callee$(_context) {\n                    while (1) switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.prev = 0;\n                        _context.next = 3;\n                        return fetch(\"http://127.0.0.1:8080/api/roles/user/\".concat(user.id), {\n                          headers: {\n                            'Content-Type': 'application/json',\n                            'Accept': 'application/json'\n                          },\n                          credentials: 'include'\n                        });\n                      case 3:\n                        rolesRes = _context.sent;\n                        _context.next = 6;\n                        return rolesRes.json();\n                      case 6:\n                        rolesData = _context.sent;\n                        console.log(\"User \".concat(user.id, \" roles:\"), rolesData); // 添加日志\n\n                        // 确保返回的角色数据是数组\n                        roles = [];\n                        if (rolesData.code === 0) {\n                          // 如果返回的是分页数据，使用list字段\n                          if (rolesData.data && Array.isArray(rolesData.data.list)) {\n                            roles = rolesData.data.list;\n                          }\n                          // 如果直接返回的是数组\n                          else if (Array.isArray(rolesData.data)) {\n                            roles = rolesData.data;\n                          }\n                        }\n                        return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, user), {}, {\n                          roles: roles\n                        }));\n                      case 13:\n                        _context.prev = 13;\n                        _context.t0 = _context[\"catch\"](0);\n                        console.error(\"\\u83B7\\u53D6\\u7528\\u6237 \".concat(user.id, \" \\u7684\\u89D2\\u8272\\u5931\\u8D25:\"), _context.t0);\n                        return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, user), {}, {\n                          roles: []\n                        }));\n                      case 17:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }, _callee, null, [[0, 13]]);\n                }));\n                return function (_x) {\n                  return _ref3.apply(this, arguments);\n                };\n              }()));\n            case 10:\n              usersWithRoles = _context2.sent;\n              console.log('Users with roles:', usersWithRoles); // 添加日志\n              users.value = usersWithRoles;\n              _context2.next = 16;\n              break;\n            case 15:\n              ElMessage.error(data.message || '获取用户列表失败');\n            case 16:\n              _context2.next = 22;\n              break;\n            case 18:\n              _context2.prev = 18;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error('获取用户列表失败:', _context2.t0);\n              ElMessage.error('获取用户列表失败');\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 18]]);\n      }));\n      return function getUsers() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    // 获取所有角色\n    var getAllRoles = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var res, data;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              console.log('开始获取角色列表...'); // 添加日志\n              _context3.next = 4;\n              return fetch('http://127.0.0.1:8080/api/roles', {\n                method: 'GET',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 4:\n              res = _context3.sent;\n              console.log('角色列表API响应状态:', res.status); // 添加日志\n              if (res.ok) {\n                _context3.next = 8;\n                break;\n              }\n              throw new Error(\"HTTP error! status: \".concat(res.status));\n            case 8:\n              _context3.next = 10;\n              return res.json();\n            case 10:\n              data = _context3.sent;\n              console.log('获取角色列表响应:', data); // 添加日志\n\n              if (data.code === 0) {\n                // 使用data.data.list获取角色列表\n                allRoles.value = data.data.list || [];\n                console.log('设置角色列表:', allRoles.value); // 添加日志\n                if (allRoles.value.length === 0) {\n                  console.warn('获取到的角色列表为空'); // 添加警告日志\n                }\n              } else {\n                console.error('获取角色列表失败:', data.message);\n                ElMessage.error(data.message || '获取角色列表失败');\n              }\n              _context3.next = 19;\n              break;\n            case 15:\n              _context3.prev = 15;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.error('获取角色列表失败:', _context3.t0);\n              ElMessage.error('获取角色列表失败: ' + _context3.t0.message);\n            case 19:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 15]]);\n      }));\n      return function getAllRoles() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    // 添加用户\n    var handleAdd = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              userForm.value = {\n                id: null,\n                username: '',\n                password: '',\n                roles: []\n              };\n              dialogTitle.value = '添加用户';\n              _context4.next = 4;\n              return getAllRoles();\n            case 4:\n              // 获取所有角色列表\n              dialogVisible.value = true;\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }));\n      return function handleAdd() {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    // 编辑用户\n    var handleEdit = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(row) {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              userForm.value = {\n                id: row.id,\n                username: row.username,\n                roles: row.roles.map(function (role) {\n                  return role.id;\n                })\n              };\n              dialogTitle.value = '编辑用户';\n              _context5.next = 4;\n              return getAllRoles();\n            case 4:\n              // 获取所有角色列表\n              dialogVisible.value = true;\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      }));\n      return function handleEdit(_x2) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    // 删除用户\n    var handleDelete = function handleDelete(row) {\n      ElMessageBox.confirm('确定要删除该用户吗？', '警告', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var res, data;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.prev = 0;\n              _context6.next = 3;\n              return fetch(\"http://localhost:8000/api/users/\".concat(row.id), {\n                method: 'DELETE',\n                credentials: 'include'\n              });\n            case 3:\n              res = _context6.sent;\n              _context6.next = 6;\n              return res.json();\n            case 6:\n              data = _context6.sent;\n              if (data.code === 0) {\n                ElMessage.success('删除成功');\n                getUsers();\n              } else {\n                ElMessage.error(data.message || '删除失败');\n              }\n              _context6.next = 14;\n              break;\n            case 10:\n              _context6.prev = 10;\n              _context6.t0 = _context6[\"catch\"](0);\n              console.error('删除用户失败:', _context6.t0);\n              ElMessage.error('删除失败');\n            case 14:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, null, [[0, 10]]);\n      })));\n    };\n\n    // 分配角色\n    var handleAssignRole = /*#__PURE__*/function () {\n      var _ref8 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(user) {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              currentUserId.value = user.id;\n              selectedRoles.value = user.roles.map(function (role) {\n                return role.id;\n              });\n              _context7.next = 4;\n              return getAllRoles();\n            case 4:\n              // 获取所有角色列表\n              roleDialogVisible.value = true;\n            case 5:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7);\n      }));\n      return function handleAssignRole(_x3) {\n        return _ref8.apply(this, arguments);\n      };\n    }();\n\n    // 提交角色分配\n    var handleRoleSubmit = /*#__PURE__*/function () {\n      var _ref9 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var _users$value$find, currentRoles, currentRoleIds, rolesToAdd, rolesToRemove, _iterator, _step, roleId, res, data, _iterator2, _step2, _roleId, _res, _data;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.prev = 0;\n              // 获取用户当前的角色\n              currentRoles = ((_users$value$find = users.value.find(function (u) {\n                return u.id === currentUserId.value;\n              })) === null || _users$value$find === void 0 ? void 0 : _users$value$find.roles) || [];\n              currentRoleIds = currentRoles.map(function (r) {\n                return r.id;\n              }); // 找出需要添加和删除的角色\n              rolesToAdd = selectedRoles.value.filter(function (id) {\n                return !currentRoleIds.includes(id);\n              });\n              rolesToRemove = currentRoleIds.filter(function (id) {\n                return !selectedRoles.value.includes(id);\n              }); // 执行添加操作\n              _iterator = _createForOfIteratorHelper(rolesToAdd);\n              _context8.prev = 6;\n              _iterator.s();\n            case 8:\n              if ((_step = _iterator.n()).done) {\n                _context8.next = 32;\n                break;\n              }\n              roleId = _step.value;\n              _context8.prev = 10;\n              _context8.next = 13;\n              return fetch(\"http://127.0.0.1:8080/api/roles/assign?userId=\".concat(currentUserId.value, \"&roleId=\").concat(roleId), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 13:\n              res = _context8.sent;\n              _context8.next = 16;\n              return res.json();\n            case 16:\n              data = _context8.sent;\n              if (!(data.code !== 0)) {\n                _context8.next = 22;\n                break;\n              }\n              if (!(data.message && data.message.includes('Duplicate entry'))) {\n                _context8.next = 21;\n                break;\n              }\n              console.warn(\"\\u89D2\\u8272 \".concat(roleId, \" \\u5DF2\\u7ECF\\u5206\\u914D\\u7ED9\\u7528\\u6237 \").concat(currentUserId.value, \"\\uFF0C\\u8DF3\\u8FC7\"));\n              return _context8.abrupt(\"continue\", 30);\n            case 21:\n              throw new Error(data.message || '分配角色失败');\n            case 22:\n              _context8.next = 30;\n              break;\n            case 24:\n              _context8.prev = 24;\n              _context8.t0 = _context8[\"catch\"](10);\n              if (!(_context8.t0.message && _context8.t0.message.includes('Duplicate entry'))) {\n                _context8.next = 29;\n                break;\n              }\n              console.warn(\"\\u89D2\\u8272 \".concat(roleId, \" \\u5DF2\\u7ECF\\u5206\\u914D\\u7ED9\\u7528\\u6237 \").concat(currentUserId.value, \"\\uFF0C\\u8DF3\\u8FC7\"));\n              return _context8.abrupt(\"continue\", 30);\n            case 29:\n              throw _context8.t0;\n            case 30:\n              _context8.next = 8;\n              break;\n            case 32:\n              _context8.next = 37;\n              break;\n            case 34:\n              _context8.prev = 34;\n              _context8.t1 = _context8[\"catch\"](6);\n              _iterator.e(_context8.t1);\n            case 37:\n              _context8.prev = 37;\n              _iterator.f();\n              return _context8.finish(37);\n            case 40:\n              // 执行删除操作\n              _iterator2 = _createForOfIteratorHelper(rolesToRemove);\n              _context8.prev = 41;\n              _iterator2.s();\n            case 43:\n              if ((_step2 = _iterator2.n()).done) {\n                _context8.next = 55;\n                break;\n              }\n              _roleId = _step2.value;\n              _context8.next = 47;\n              return fetch(\"http://127.0.0.1:8080/api/roles/remove?userId=\".concat(currentUserId.value, \"&roleId=\").concat(_roleId), {\n                method: 'DELETE',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 47:\n              _res = _context8.sent;\n              _context8.next = 50;\n              return _res.json();\n            case 50:\n              _data = _context8.sent;\n              if (!(_data.code !== 0)) {\n                _context8.next = 53;\n                break;\n              }\n              throw new Error(_data.message || '移除角色失败');\n            case 53:\n              _context8.next = 43;\n              break;\n            case 55:\n              _context8.next = 60;\n              break;\n            case 57:\n              _context8.prev = 57;\n              _context8.t2 = _context8[\"catch\"](41);\n              _iterator2.e(_context8.t2);\n            case 60:\n              _context8.prev = 60;\n              _iterator2.f();\n              return _context8.finish(60);\n            case 63:\n              ElMessage.success('角色分配成功');\n              roleDialogVisible.value = false;\n              _context8.next = 67;\n              return getUsers();\n            case 67:\n              _context8.next = 73;\n              break;\n            case 69:\n              _context8.prev = 69;\n              _context8.t3 = _context8[\"catch\"](0);\n              console.error('分配角色失败:', _context8.t3);\n              ElMessage.error(_context8.t3.message || '分配角色失败');\n            case 73:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, null, [[0, 69], [6, 34, 37, 40], [10, 24], [41, 57, 60, 63]]);\n      }));\n      return function handleRoleSubmit() {\n        return _ref9.apply(this, arguments);\n      };\n    }();\n\n    // 提交表单\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref10 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n        var url, method, requestBody, res, data, userId, _iterator3, _step3, roleId, _users$value$find2, _userId, currentRoles, rolesToAdd, rolesToRemove, _iterator4, _step4, _roleId2, _iterator5, _step5, _roleId3;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.prev = 0;\n              if (!(!userForm.value.id && userForm.value.password.length < settingsStore.passwordMinLength)) {\n                _context9.next = 4;\n                break;\n              }\n              ElMessage.error(\"\\u5BC6\\u7801\\u957F\\u5EA6\\u4E0D\\u80FD\\u5C0F\\u4E8E\".concat(settingsStore.passwordMinLength, \"\\u4F4D\"));\n              return _context9.abrupt(\"return\");\n            case 4:\n              url = userForm.value.id ? \"http://localhost:8080/api/users/\".concat(userForm.value.id) : 'http://localhost:8080/api/register';\n              method = userForm.value.id ? 'PUT' : 'POST'; // 创建/更新用户的请求体\n              requestBody = {\n                username: userForm.value.username\n              }; // 只在添加用户时包含密码字段\n              if (!userForm.value.id) {\n                requestBody.password = userForm.value.password;\n              }\n\n              // 创建/更新用户\n              _context9.next = 10;\n              return fetch(url, {\n                method: method,\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include',\n                body: JSON.stringify(requestBody)\n              });\n            case 10:\n              res = _context9.sent;\n              _context9.next = 13;\n              return res.json();\n            case 13:\n              data = _context9.sent;\n              if (!(data.code === 0)) {\n                _context9.next = 81;\n                break;\n              }\n              if (!(!userForm.value.id && userForm.value.roles.length > 0)) {\n                _context9.next = 36;\n                break;\n              }\n              userId = data.data.id; // 为新用户分配角色\n              _iterator3 = _createForOfIteratorHelper(userForm.value.roles);\n              _context9.prev = 18;\n              _iterator3.s();\n            case 20:\n              if ((_step3 = _iterator3.n()).done) {\n                _context9.next = 26;\n                break;\n              }\n              roleId = _step3.value;\n              _context9.next = 24;\n              return fetch(\"http://127.0.0.1:8080/api/roles/assign?userId=\".concat(userId, \"&roleId=\").concat(roleId), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 24:\n              _context9.next = 20;\n              break;\n            case 26:\n              _context9.next = 31;\n              break;\n            case 28:\n              _context9.prev = 28;\n              _context9.t0 = _context9[\"catch\"](18);\n              _iterator3.e(_context9.t0);\n            case 31:\n              _context9.prev = 31;\n              _iterator3.f();\n              return _context9.finish(31);\n            case 34:\n              _context9.next = 75;\n              break;\n            case 36:\n              if (!userForm.value.id) {\n                _context9.next = 75;\n                break;\n              }\n              _userId = userForm.value.id;\n              currentRoles = ((_users$value$find2 = users.value.find(function (user) {\n                return user.id === _userId;\n              })) === null || _users$value$find2 === void 0 ? void 0 : _users$value$find2.roles.map(function (role) {\n                return role.id;\n              })) || []; // 需要添加的角色\n              rolesToAdd = userForm.value.roles.filter(function (roleId) {\n                return !currentRoles.includes(roleId);\n              }); // 需要移除的角色\n              rolesToRemove = currentRoles.filter(function (roleId) {\n                return !userForm.value.roles.includes(roleId);\n              }); // 添加新角色\n              _iterator4 = _createForOfIteratorHelper(rolesToAdd);\n              _context9.prev = 42;\n              _iterator4.s();\n            case 44:\n              if ((_step4 = _iterator4.n()).done) {\n                _context9.next = 50;\n                break;\n              }\n              _roleId2 = _step4.value;\n              _context9.next = 48;\n              return fetch(\"http://127.0.0.1:8080/api/roles/assign?userId=\".concat(_userId, \"&roleId=\").concat(_roleId2), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 48:\n              _context9.next = 44;\n              break;\n            case 50:\n              _context9.next = 55;\n              break;\n            case 52:\n              _context9.prev = 52;\n              _context9.t1 = _context9[\"catch\"](42);\n              _iterator4.e(_context9.t1);\n            case 55:\n              _context9.prev = 55;\n              _iterator4.f();\n              return _context9.finish(55);\n            case 58:\n              // 移除旧角色\n              _iterator5 = _createForOfIteratorHelper(rolesToRemove);\n              _context9.prev = 59;\n              _iterator5.s();\n            case 61:\n              if ((_step5 = _iterator5.n()).done) {\n                _context9.next = 67;\n                break;\n              }\n              _roleId3 = _step5.value;\n              _context9.next = 65;\n              return fetch(\"http://127.0.0.1:8080/api/roles/remove?userId=\".concat(_userId, \"&roleId=\").concat(_roleId3), {\n                method: 'DELETE',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 65:\n              _context9.next = 61;\n              break;\n            case 67:\n              _context9.next = 72;\n              break;\n            case 69:\n              _context9.prev = 69;\n              _context9.t2 = _context9[\"catch\"](59);\n              _iterator5.e(_context9.t2);\n            case 72:\n              _context9.prev = 72;\n              _iterator5.f();\n              return _context9.finish(72);\n            case 75:\n              ElMessage.success(userForm.value.id ? '更新成功' : '添加成功');\n              dialogVisible.value = false;\n              // 立即重新获取用户列表以更新角色信息\n              _context9.next = 79;\n              return getUsers();\n            case 79:\n              _context9.next = 82;\n              break;\n            case 81:\n              ElMessage.error(data.message || (userForm.value.id ? '更新失败' : '添加失败'));\n            case 82:\n              _context9.next = 88;\n              break;\n            case 84:\n              _context9.prev = 84;\n              _context9.t3 = _context9[\"catch\"](0);\n              console.error('提交表单失败:', _context9.t3);\n              ElMessage.error(userForm.value.id ? '更新失败' : '添加失败');\n            case 88:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, null, [[0, 84], [18, 28, 31, 34], [42, 52, 55, 58], [59, 69, 72, 75]]);\n      }));\n      return function handleSubmit() {\n        return _ref10.apply(this, arguments);\n      };\n    }();\n    onMounted(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.next = 2;\n            return Promise.all([getUsers(), getAllRoles() // 在组件挂载时获取角色列表\n            ]);\n          case 2:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10);\n    })));\n    var __returned__ = {\n      users: users,\n      allRoles: allRoles,\n      selectedRoles: selectedRoles,\n      currentUserId: currentUserId,\n      settingsStore: settingsStore,\n      dialogVisible: dialogVisible,\n      roleDialogVisible: roleDialogVisible,\n      dialogTitle: dialogTitle,\n      userForm: userForm,\n      getUsers: getUsers,\n      getAllRoles: getAllRoles,\n      handleAdd: handleAdd,\n      handleEdit: handleEdit,\n      handleDelete: handleDelete,\n      handleAssignRole: handleAssignRole,\n      handleRoleSubmit: handleRoleSubmit,\n      handleSubmit: handleSubmit,\n      ref: ref,\n      onMounted: onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get ElMessageBox() {\n        return ElMessageBox;\n      },\n      get useSettingsStore() {\n        return useSettingsStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","ElMessage","ElMessageBox","useSettingsStore","users","allRoles","selectedRoles","currentUserId","settingsStore","dialogVisible","roleDialogVisible","dialogTitle","userForm","id","username","password","roles","getUsers","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","res","data","usersWithRoles","wrap","_callee2$","_context2","prev","next","fetch","headers","credentials","sent","json","code","Promise","all","map","_ref3","_callee","user","rolesRes","rolesData","_callee$","_context","concat","console","log","Array","isArray","list","abrupt","_objectSpread","t0","error","stop","_x","apply","arguments","value","message","getAllRoles","_ref4","_callee3","_callee3$","_context3","method","status","ok","Error","length","warn","handleAdd","_ref5","_callee4","_callee4$","_context4","handleEdit","_ref6","_callee5","row","_callee5$","_context5","role","_x2","handleDelete","confirm","confirmButtonText","cancelButtonText","type","then","_callee6","_callee6$","_context6","success","handleAssignRole","_ref8","_callee7","_callee7$","_context7","_x3","handleRoleSubmit","_ref9","_callee8","_users$value$find","currentRoles","currentRoleIds","rolesToAdd","rolesToRemove","_iterator","_step","roleId","_iterator2","_step2","_roleId","_res","_data","_callee8$","_context8","find","u","r","filter","includes","_createForOfIteratorHelper","s","n","done","t1","e","f","finish","t2","t3","handleSubmit","_ref10","_callee9","url","requestBody","userId","_iterator3","_step3","_users$value$find2","_userId","_iterator4","_step4","_roleId2","_iterator5","_step5","_roleId3","_callee9$","_context9","passwordMinLength","body","JSON","stringify","_callee10","_callee10$","_context10"],"sources":["C:/Users/indexae/Desktop/scm/scm/frontend/src/views/UserManage.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-manage\">\r\n    <el-card class=\"box-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>用户管理</span>\r\n          <el-button type=\"primary\" @click=\"handleAdd\">添加用户</el-button>\r\n        </div>\r\n      </template>\r\n      \r\n      <!-- 用户列表 -->\r\n      <el-table :data=\"users\" style=\"width: 100%\">\r\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n        <el-table-column prop=\"username\" label=\"用户名\" />\r\n        <el-table-column label=\"角色\" width=\"200\">\r\n          <template #default=\"scope\">\r\n            <el-tag\r\n              v-for=\"role in scope.row.roles\"\r\n              :key=\"role.id\"\r\n              class=\"role-tag\"\r\n              type=\"info\">\r\n              {{ role.roleName }}\r\n            </el-tag>\r\n            <el-button \r\n              link \r\n              type=\"primary\" \r\n              size=\"small\"\r\n              @click=\"handleAssignRole(scope.row)\">\r\n              分配角色\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"角色状态\" width=\"120\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"scope.row.roles.length > 0 ? 'success' : 'warning'\">\r\n              {{ scope.row.roles.length > 0 ? '已分配' : '未分配' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"创建时间\" />\r\n        <el-table-column prop=\"updateTime\" label=\"更新时间\" />\r\n        <el-table-column label=\"操作\" width=\"200\">\r\n          <template #default=\"scope\">\r\n            <el-button size=\"small\" @click=\"handleEdit(scope.row)\">编辑</el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click=\"handleDelete(scope.row)\">删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <!-- 添加/编辑用户对话框 -->\r\n    <el-dialog \r\n      :title=\"dialogTitle\" \r\n      v-model=\"dialogVisible\" \r\n      width=\"500px\">\r\n      <el-form \r\n        :model=\"userForm\" \r\n        label-width=\"100px\">\r\n        <el-form-item label=\"用户名\">\r\n          <el-input v-model=\"userForm.username\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" v-if=\"!userForm.id\">\r\n          <el-input v-model=\"userForm.password\" type=\"password\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"角色\">\r\n          <el-select v-model=\"userForm.roles\" multiple placeholder=\"请选择角色\">\r\n            <el-option\r\n              v-for=\"role in allRoles\"\r\n              :key=\"role.id\"\r\n              :label=\"role.roleName\"\r\n              :value=\"role.id\">\r\n              {{ role.roleName }}\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"handleSubmit\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 分配角色对话框 -->\r\n    <el-dialog\r\n      title=\"分配角色\"\r\n      v-model=\"roleDialogVisible\"\r\n      width=\"500px\">\r\n      <el-form>\r\n        <el-form-item label=\"选择角色\">\r\n          <el-checkbox-group v-model=\"selectedRoles\">\r\n            <el-checkbox\r\n              v-for=\"role in allRoles\"\r\n              :key=\"role.id\"\r\n              :value=\"role.id\">\r\n              {{ role.roleName }}\r\n            </el-checkbox>\r\n          </el-checkbox-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"roleDialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"handleRoleSubmit\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { useSettingsStore } from '../stores/settings'\r\n\r\n// 用户列表数据\r\nconst users = ref([])\r\nconst allRoles = ref([]) // 所有角色列表\r\nconst selectedRoles = ref([]) // 选中的角色ID列表\r\nconst currentUserId = ref(null) // 当前操作的用户ID\r\nconst settingsStore = useSettingsStore()\r\n\r\n// 对话框相关数据\r\nconst dialogVisible = ref(false)\r\nconst roleDialogVisible = ref(false)\r\nconst dialogTitle = ref('添加用户')\r\nconst userForm = ref({\r\n  id: null,\r\n  username: '',\r\n  password: '',\r\n  roles: [] // 添加角色字段\r\n})\r\n\r\n// 获取用户列表\r\nconst getUsers = async () => {\r\n  try {\r\n    const res = await fetch('http://127.0.0.1:8080/api/users', {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include'\r\n    })\r\n    const data = await res.json()\r\n    if (data.code === 0) {\r\n      // 获取每个用户的角色信息\r\n      const usersWithRoles = await Promise.all(\r\n        data.data.map(async (user) => {\r\n          try {\r\n            const rolesRes = await fetch(`http://127.0.0.1:8080/api/roles/user/${user.id}`, {\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Accept': 'application/json'\r\n              },\r\n              credentials: 'include'\r\n            })\r\n            const rolesData = await rolesRes.json()\r\n            console.log(`User ${user.id} roles:`, rolesData) // 添加日志\r\n            \r\n            // 确保返回的角色数据是数组\r\n            let roles = []\r\n            if (rolesData.code === 0) {\r\n              // 如果返回的是分页数据，使用list字段\r\n              if (rolesData.data && Array.isArray(rolesData.data.list)) {\r\n                roles = rolesData.data.list\r\n              }\r\n              // 如果直接返回的是数组\r\n              else if (Array.isArray(rolesData.data)) {\r\n                roles = rolesData.data\r\n              }\r\n            }\r\n            \r\n            return {\r\n              ...user,\r\n              roles: roles\r\n            }\r\n          } catch (error) {\r\n            console.error(`获取用户 ${user.id} 的角色失败:`, error)\r\n            return {\r\n              ...user,\r\n              roles: []\r\n            }\r\n          }\r\n        })\r\n      )\r\n      console.log('Users with roles:', usersWithRoles) // 添加日志\r\n      users.value = usersWithRoles\r\n    } else {\r\n      ElMessage.error(data.message || '获取用户列表失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取用户列表失败:', error)\r\n    ElMessage.error('获取用户列表失败')\r\n  }\r\n}\r\n\r\n// 获取所有角色\r\nconst getAllRoles = async () => {\r\n  try {\r\n    console.log('开始获取角色列表...') // 添加日志\r\n    const res = await fetch('http://127.0.0.1:8080/api/roles', {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include'\r\n    })\r\n    \r\n    console.log('角色列表API响应状态:', res.status) // 添加日志\r\n    \r\n    if (!res.ok) {\r\n      throw new Error(`HTTP error! status: ${res.status}`)\r\n    }\r\n    \r\n    const data = await res.json()\r\n    console.log('获取角色列表响应:', data) // 添加日志\r\n    \r\n    if (data.code === 0) {\r\n      // 使用data.data.list获取角色列表\r\n      allRoles.value = data.data.list || []\r\n      console.log('设置角色列表:', allRoles.value) // 添加日志\r\n      if (allRoles.value.length === 0) {\r\n        console.warn('获取到的角色列表为空') // 添加警告日志\r\n      }\r\n    } else {\r\n      console.error('获取角色列表失败:', data.message)\r\n      ElMessage.error(data.message || '获取角色列表失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取角色列表失败:', error)\r\n    ElMessage.error('获取角色列表失败: ' + error.message)\r\n  }\r\n}\r\n\r\n// 添加用户\r\nconst handleAdd = async () => {\r\n  userForm.value = {\r\n    id: null,\r\n    username: '',\r\n    password: '',\r\n    roles: []\r\n  }\r\n  dialogTitle.value = '添加用户'\r\n  await getAllRoles() // 获取所有角色列表\r\n  dialogVisible.value = true\r\n}\r\n\r\n// 编辑用户\r\nconst handleEdit = async (row) => {\r\n  userForm.value = {\r\n    id: row.id,\r\n    username: row.username,\r\n    roles: row.roles.map(role => role.id)\r\n  }\r\n  dialogTitle.value = '编辑用户'\r\n  await getAllRoles() // 获取所有角色列表\r\n  dialogVisible.value = true\r\n}\r\n\r\n// 删除用户\r\nconst handleDelete = (row) => {\r\n  ElMessageBox.confirm(\r\n    '确定要删除该用户吗？',\r\n    '警告',\r\n    {\r\n      confirmButtonText: '确定',\r\n      cancelButtonText: '取消',\r\n      type: 'warning',\r\n    }\r\n  ).then(async () => {\r\n    try {\r\n      const res = await fetch(`http://localhost:8000/api/users/${row.id}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include'\r\n      })\r\n      const data = await res.json()\r\n      if (data.code === 0) {\r\n        ElMessage.success('删除成功')\r\n        getUsers()\r\n      } else {\r\n        ElMessage.error(data.message || '删除失败')\r\n      }\r\n    } catch (error) {\r\n      console.error('删除用户失败:', error)\r\n      ElMessage.error('删除失败')\r\n    }\r\n  })\r\n}\r\n\r\n// 分配角色\r\nconst handleAssignRole = async (user) => {\r\n  currentUserId.value = user.id\r\n  selectedRoles.value = user.roles.map(role => role.id)\r\n  await getAllRoles() // 获取所有角色列表\r\n  roleDialogVisible.value = true\r\n}\r\n\r\n// 提交角色分配\r\nconst handleRoleSubmit = async () => {\r\n  try {\r\n    // 获取用户当前的角色\r\n    const currentRoles = users.value.find(u => u.id === currentUserId.value)?.roles || []\r\n    const currentRoleIds = currentRoles.map(r => r.id)\r\n    \r\n    // 找出需要添加和删除的角色\r\n    const rolesToAdd = selectedRoles.value.filter(id => !currentRoleIds.includes(id))\r\n    const rolesToRemove = currentRoleIds.filter(id => !selectedRoles.value.includes(id))\r\n    \r\n    // 执行添加操作\r\n    for (const roleId of rolesToAdd) {\r\n      try {\r\n        const res = await fetch(`http://127.0.0.1:8080/api/roles/assign?userId=${currentUserId.value}&roleId=${roleId}`, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json'\r\n          },\r\n          credentials: 'include'\r\n        })\r\n        const data = await res.json()\r\n        if (data.code !== 0) {\r\n          // 如果是重复分配的错误，跳过这个角色\r\n          if (data.message && data.message.includes('Duplicate entry')) {\r\n            console.warn(`角色 ${roleId} 已经分配给用户 ${currentUserId.value}，跳过`)\r\n            continue\r\n          }\r\n          throw new Error(data.message || '分配角色失败')\r\n        }\r\n      } catch (error) {\r\n        if (error.message && error.message.includes('Duplicate entry')) {\r\n          console.warn(`角色 ${roleId} 已经分配给用户 ${currentUserId.value}，跳过`)\r\n          continue\r\n        }\r\n        throw error\r\n      }\r\n    }\r\n    \r\n    // 执行删除操作\r\n    for (const roleId of rolesToRemove) {\r\n      const res = await fetch(`http://127.0.0.1:8080/api/roles/remove?userId=${currentUserId.value}&roleId=${roleId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json'\r\n        },\r\n        credentials: 'include'\r\n      })\r\n      const data = await res.json()\r\n      if (data.code !== 0) {\r\n        throw new Error(data.message || '移除角色失败')\r\n      }\r\n    }\r\n    \r\n    ElMessage.success('角色分配成功')\r\n    roleDialogVisible.value = false\r\n    await getUsers() // 刷新用户列表\r\n  } catch (error) {\r\n    console.error('分配角色失败:', error)\r\n    ElMessage.error(error.message || '分配角色失败')\r\n  }\r\n}\r\n\r\n// 提交表单\r\nconst handleSubmit = async () => {\r\n  try {\r\n    // 如果是添加用户，验证密码长度\r\n    if (!userForm.value.id && userForm.value.password.length < settingsStore.passwordMinLength) {\r\n      ElMessage.error(`密码长度不能小于${settingsStore.passwordMinLength}位`)\r\n      return\r\n    }\r\n\r\n    const url = userForm.value.id \r\n      ? `http://localhost:8080/api/users/${userForm.value.id}`\r\n      : 'http://localhost:8080/api/register'\r\n    const method = userForm.value.id ? 'PUT' : 'POST'\r\n    \r\n    // 创建/更新用户的请求体\r\n    const requestBody = {\r\n      username: userForm.value.username\r\n    }\r\n    \r\n    // 只在添加用户时包含密码字段\r\n    if (!userForm.value.id) {\r\n      requestBody.password = userForm.value.password\r\n    }\r\n    \r\n    // 创建/更新用户\r\n    const res = await fetch(url, {\r\n      method,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include',\r\n      body: JSON.stringify(requestBody)\r\n    })\r\n    \r\n    const data = await res.json()\r\n    if (data.code === 0) {\r\n      // 如果是添加用户，需要分配角色\r\n      if (!userForm.value.id && userForm.value.roles.length > 0) {\r\n        const userId = data.data.id\r\n        // 为新用户分配角色\r\n        for (const roleId of userForm.value.roles) {\r\n          await fetch(`http://127.0.0.1:8080/api/roles/assign?userId=${userId}&roleId=${roleId}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Accept': 'application/json'\r\n            },\r\n            credentials: 'include'\r\n          })\r\n        }\r\n      }\r\n      // 如果是编辑用户，更新角色\r\n      else if (userForm.value.id) {\r\n        const userId = userForm.value.id\r\n        const currentRoles = users.value\r\n          .find(user => user.id === userId)\r\n          ?.roles.map(role => role.id) || []\r\n        \r\n        // 需要添加的角色\r\n        const rolesToAdd = userForm.value.roles.filter(roleId => !currentRoles.includes(roleId))\r\n        // 需要移除的角色\r\n        const rolesToRemove = currentRoles.filter(roleId => !userForm.value.roles.includes(roleId))\r\n\r\n        // 添加新角色\r\n        for (const roleId of rolesToAdd) {\r\n          await fetch(`http://127.0.0.1:8080/api/roles/assign?userId=${userId}&roleId=${roleId}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Accept': 'application/json'\r\n            },\r\n            credentials: 'include'\r\n          })\r\n        }\r\n\r\n        // 移除旧角色\r\n        for (const roleId of rolesToRemove) {\r\n          await fetch(`http://127.0.0.1:8080/api/roles/remove?userId=${userId}&roleId=${roleId}`, {\r\n            method: 'DELETE',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Accept': 'application/json'\r\n            },\r\n            credentials: 'include'\r\n          })\r\n        }\r\n      }\r\n\r\n      ElMessage.success(userForm.value.id ? '更新成功' : '添加成功')\r\n      dialogVisible.value = false\r\n      // 立即重新获取用户列表以更新角色信息\r\n      await getUsers()\r\n    } else {\r\n      ElMessage.error(data.message || (userForm.value.id ? '更新失败' : '添加失败'))\r\n    }\r\n  } catch (error) {\r\n    console.error('提交表单失败:', error)\r\n    ElMessage.error(userForm.value.id ? '更新失败' : '添加失败')\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  await Promise.all([\r\n    getUsers(),\r\n    getAllRoles() // 在组件挂载时获取角色列表\r\n  ])\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.user-manage {\r\n  padding: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.dialog-footer {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 10px;\r\n}\r\n\r\n.role-tag {\r\n  margin-right: 5px;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}