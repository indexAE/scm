{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"operation-log\"\n};\nvar _hoisted_2 = {\n  \"class\": \"header\"\n};\nvar _hoisted_3 = {\n  \"class\": \"pagination\",\n  style: {\n    \"margin-top\": \"20px\",\n    \"text-align\": \"right\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_table_column = _resolveComponent(\"el-table-column\");\n  var _component_el_table = _resolveComponent(\"el-table\");\n  var _component_el_pagination = _resolveComponent(\"el-pagination\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_date_picker, {\n    modelValue: $setup.dateRange,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.dateRange = $event;\n    }),\n    type: \"daterange\",\n    \"range-separator\": \"至\",\n    \"start-placeholder\": \"开始日期\",\n    \"end-placeholder\": \"结束日期\",\n    \"value-format\": \"YYYY-MM-DD\",\n    onChange: $setup.handleDateChange\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: $setup.fetchLogs\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[3] || (_cache[3] = [_createTextVNode(\"查询\")]);\n    }),\n    _: 1 /* STABLE */\n  })]), _createVNode(_component_el_table, {\n    data: $setup.logs,\n    border: \"\",\n    style: {\n      \"width\": \"100%\",\n      \"margin-top\": \"20px\"\n    }\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_el_table_column, {\n        prop: \"id\",\n        label: \"ID\",\n        width: \"80\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"username\",\n        label: \"用户名\",\n        width: \"120\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"operation\",\n        label: \"操作内容\",\n        width: \"180\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"method\",\n        label: \"请求方法\",\n        width: \"100\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"params\",\n        label: \"请求参数\",\n        \"show-overflow-tooltip\": \"\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"ip\",\n        label: \"IP地址\",\n        width: \"140\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"operationTime\",\n        label: \"操作时间\",\n        width: \"180\"\n      })];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"data\"]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_pagination, {\n    \"current-page\": $setup.currentPage,\n    \"onUpdate:currentPage\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.currentPage = $event;\n    }),\n    \"page-size\": $setup.pageSize,\n    \"onUpdate:pageSize\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.pageSize = $event;\n    }),\n    total: $setup.total,\n    \"page-sizes\": [10, 20, 50, 100],\n    layout: \"total, sizes, prev, pager, next, jumper\",\n    onSizeChange: $setup.handleSizeChange,\n    onCurrentChange: $setup.handleCurrentChange\n  }, null, 8 /* PROPS */, [\"current-page\", \"page-size\", \"total\"])])]);\n}","map":{"version":3,"names":["style","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_date_picker","modelValue","$setup","dateRange","_cache","$event","type","onChange","handleDateChange","_component_el_button","onClick","fetchLogs","_withCtx","_createTextVNode","_","_component_el_table","data","logs","border","_component_el_table_column","prop","label","width","_hoisted_3","_component_el_pagination","currentPage","pageSize","total","layout","onSizeChange","handleSizeChange","onCurrentChange","handleCurrentChange"],"sources":["C:\\Users\\indexae\\Desktop\\scm\\frontend\\src\\components\\OperationLog.vue"],"sourcesContent":["<template>\r\n  <div class=\"operation-log\">\r\n    <div class=\"header\">\r\n      <el-date-picker\r\n        v-model=\"dateRange\"\r\n        type=\"daterange\"\r\n        range-separator=\"至\"\r\n        start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\"\r\n        value-format=\"YYYY-MM-DD\"\r\n        @change=\"handleDateChange\"\r\n      />\r\n      <el-button type=\"primary\" @click=\"fetchLogs\">查询</el-button>\r\n    </div>\r\n    \r\n    <el-table :data=\"logs\" border style=\"width: 100%; margin-top: 20px;\">\r\n      <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n      <el-table-column prop=\"username\" label=\"用户名\" width=\"120\" />\r\n      <el-table-column prop=\"operation\" label=\"操作内容\" width=\"180\" />\r\n      <el-table-column prop=\"method\" label=\"请求方法\" width=\"100\" />\r\n      <el-table-column prop=\"params\" label=\"请求参数\" show-overflow-tooltip />\r\n      <el-table-column prop=\"ip\" label=\"IP地址\" width=\"140\" />\r\n      <el-table-column prop=\"operationTime\" label=\"操作时间\" width=\"180\" />\r\n    </el-table>\r\n    \r\n    <div class=\"pagination\" style=\"margin-top: 20px; text-align: right;\">\r\n      <el-pagination\r\n        v-model:current-page=\"currentPage\"\r\n        v-model:page-size=\"pageSize\"\r\n        :total=\"total\"\r\n        :page-sizes=\"[10, 20, 50, 100]\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport axios from 'axios'\r\n\r\nconst logs = ref([])\r\nconst total = ref(0)\r\nconst currentPage = ref(1)\r\nconst pageSize = ref(10)\r\nconst dateRange = ref([])\r\n\r\nconst fetchLogs = async () => {\r\n  try {\r\n    const startDate = dateRange.value?.[0] || ''\r\n    const endDate = dateRange.value?.[1] || ''\r\n    const response = await axios.get('/api/logs/operation', {\r\n      params: {\r\n        startDate,\r\n        endDate,\r\n        page: currentPage.value,\r\n        size: pageSize.value\r\n      }\r\n    })\r\n    if (response.data.code === 0) {\r\n      logs.value = response.data.data.logs\r\n      total.value = response.data.data.total\r\n    } else {\r\n      ElMessage.error(response.data.message || '获取操作日志失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取操作日志失败:', error)\r\n    ElMessage.error('获取操作日志失败')\r\n  }\r\n}\r\n\r\nconst handleSizeChange = (val) => {\r\n  pageSize.value = val\r\n  fetchLogs()\r\n}\r\n\r\nconst handleCurrentChange = (val) => {\r\n  currentPage.value = val\r\n  fetchLogs()\r\n}\r\n\r\nconst handleDateChange = () => {\r\n  currentPage.value = 1\r\n  fetchLogs()\r\n}\r\n\r\nonMounted(() => {\r\n  fetchLogs()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.operation-log {\r\n  padding: 20px;\r\n}\r\n\r\n.header {\r\n  display: flex;\r\n  gap: 20px;\r\n  align-items: center;\r\n}\r\n</style> "],"mappings":";;EACO,SAAM;AAAe;;EACnB,SAAM;AAAQ;;EAuBd,SAAM,YAAY;EAACA,KAA4C,EAA5C;IAAA;IAAA;EAAA;;;;;;;;uBAxB1BC,mBAAA,CAmCM,OAnCNC,UAmCM,GAlCJC,mBAAA,CAWM,OAXNC,UAWM,GAVJC,YAAA,CAQEC,yBAAA;IAXRC,UAAA,EAIiBC,MAAA,CAAAC,SAAS;IAJ1B,uBAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OAIiBH,MAAA,CAAAC,SAAS,GAAAE,MAAA;IAAA;IAClBC,IAAI,EAAC,WAAW;IAChB,iBAAe,EAAC,GAAG;IACnB,mBAAiB,EAAC,MAAM;IACxB,iBAAe,EAAC,MAAM;IACtB,cAAY,EAAC,YAAY;IACxBC,QAAM,EAAEL,MAAA,CAAAM;2CAEXT,YAAA,CAA2DU,oBAAA;IAAhDH,IAAI,EAAC,SAAS;IAAEI,OAAK,EAAER,MAAA,CAAAS;;IAZxC,WAAAC,QAAA,CAYmD;MAAA,OAAER,MAAA,QAAAA,MAAA,OAZrDS,gBAAA,CAYmD,IAAE,E;;IAZrDC,CAAA;QAeIf,YAAA,CAQWgB,mBAAA;IARAC,IAAI,EAAEd,MAAA,CAAAe,IAAI;IAAEC,MAAM,EAAN,EAAM;IAACxB,KAAsC,EAAtC;MAAA;MAAA;IAAA;;IAflC,WAAAkB,QAAA,CAgBM;MAAA,OAAmD,CAAnDb,YAAA,CAAmDoB,0BAAA;QAAlCC,IAAI,EAAC,IAAI;QAACC,KAAK,EAAC,IAAI;QAACC,KAAK,EAAC;UAC5CvB,YAAA,CAA2DoB,0BAAA;QAA1CC,IAAI,EAAC,UAAU;QAACC,KAAK,EAAC,KAAK;QAACC,KAAK,EAAC;UACnDvB,YAAA,CAA6DoB,0BAAA;QAA5CC,IAAI,EAAC,WAAW;QAACC,KAAK,EAAC,MAAM;QAACC,KAAK,EAAC;UACrDvB,YAAA,CAA0DoB,0BAAA;QAAzCC,IAAI,EAAC,QAAQ;QAACC,KAAK,EAAC,MAAM;QAACC,KAAK,EAAC;UAClDvB,YAAA,CAAoEoB,0BAAA;QAAnDC,IAAI,EAAC,QAAQ;QAACC,KAAK,EAAC,MAAM;QAAC,uBAAqB,EAArB;UAC5CtB,YAAA,CAAsDoB,0BAAA;QAArCC,IAAI,EAAC,IAAI;QAACC,KAAK,EAAC,MAAM;QAACC,KAAK,EAAC;UAC9CvB,YAAA,CAAiEoB,0BAAA;QAAhDC,IAAI,EAAC,eAAe;QAACC,KAAK,EAAC,MAAM;QAACC,KAAK,EAAC;;;IAtB/DR,CAAA;+BAyBIjB,mBAAA,CAUM,OAVN0B,UAUM,GATJxB,YAAA,CAQEyB,wBAAA;IAPQ,cAAY,EAAEtB,MAAA,CAAAuB,WAAW;IA3BzC,wBAAArB,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OA2B8BH,MAAA,CAAAuB,WAAW,GAAApB,MAAA;IAAA;IACzB,WAAS,EAAEH,MAAA,CAAAwB,QAAQ;IA5BnC,qBAAAtB,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OA4B2BH,MAAA,CAAAwB,QAAQ,GAAArB,MAAA;IAAA;IAC1BsB,KAAK,EAAEzB,MAAA,CAAAyB,KAAK;IACZ,YAAU,EAAE,iBAAiB;IAC9BC,MAAM,EAAC,yCAAyC;IAC/CC,YAAW,EAAE3B,MAAA,CAAA4B,gBAAgB;IAC7BC,eAAc,EAAE7B,MAAA,CAAA8B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}