{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/indexae/Desktop/scm\\u9000\\u8D27/scm/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/indexae/Desktop/scm\\u9000\\u8D27/scm/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.string.pad-start.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { ref, reactive, computed, onMounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nexport default {\n  __name: 'form',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var route = useRoute();\n    var router = useRouter();\n    var formRef = ref(null);\n    var submitting = ref(false);\n\n    // 获取路由参数\n    var id = route.query.id;\n    var mode = route.query.mode;\n    var isView = computed(function () {\n      return mode === 'view';\n    });\n\n    // 表单标题\n    var formTitle = computed(function () {\n      if (isView.value) return '查看销售差异';\n      return id ? '编辑销售差异' : '新增销售差异';\n    });\n\n    // 生成差异单号\n    var generateVarianceNo = function generateVarianceNo() {\n      var date = new Date();\n      var year = date.getFullYear();\n      var month = String(date.getMonth() + 1).padStart(2, '0');\n      var day = String(date.getDate()).padStart(2, '0');\n      var random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');\n      return \"CY\".concat(year).concat(month).concat(day).concat(random);\n    };\n\n    // 表单数据\n    var form = reactive({\n      varianceNo: generateVarianceNo(),\n      // 初始化时生成差异单号\n      orderId: '',\n      orderNo: '',\n      customerId: '',\n      customerName: '',\n      productId: '',\n      productName: '',\n      orderQuantity: 0,\n      actualQuantity: 0,\n      varianceQuantity: 0,\n      unitPrice: 0,\n      amount: 0,\n      type: 'quantity',\n      reason: '',\n      solution: '',\n      remark: '',\n      status: 'pending'\n    });\n\n    // 表单验证规则\n    var rules = {\n      orderId: [{\n        required: true,\n        message: '请选择关联订单',\n        trigger: 'change'\n      }],\n      productId: [{\n        required: true,\n        message: '请选择商品',\n        trigger: 'change'\n      }],\n      actualQuantity: [{\n        required: true,\n        message: '请输入实际数量',\n        trigger: 'blur'\n      }],\n      reason: [{\n        required: true,\n        message: '请输入差异原因',\n        trigger: 'blur'\n      }]\n    };\n\n    // 订单列表\n    var orders = ref([]);\n    // 商品列表\n    var products = ref([]);\n\n    // 获取订单列表\n    var getOrders = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var response, result;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return fetch('http://127.0.0.1:8080/api/sale/orders?status=completed', {\n                headers: {\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 3:\n              response = _context.sent;\n              _context.next = 6;\n              return response.json();\n            case 6:\n              result = _context.sent;\n              if (result.code === 0) {\n                orders.value = result.data.list || [];\n              } else {\n                ElMessage.error(result.message || '获取订单列表失败');\n              }\n              _context.next = 14;\n              break;\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('获取订单列表失败:', _context.t0);\n              ElMessage.error('获取订单列表失败');\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 10]]);\n      }));\n      return function getOrders() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    // 获取商品列表\n    var getProducts = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var response, result;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return fetch('http://127.0.0.1:8080/api/products', {\n                headers: {\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 3:\n              response = _context2.sent;\n              _context2.next = 6;\n              return response.json();\n            case 6:\n              result = _context2.sent;\n              if (result.code === 0) {\n                products.value = result.data.list || [];\n              } else {\n                ElMessage.error(result.message || '获取商品列表失败');\n              }\n              _context2.next = 14;\n              break;\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error('获取商品列表失败:', _context2.t0);\n              ElMessage.error('获取商品列表失败');\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 10]]);\n      }));\n      return function getProducts() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    // 获取差异单详情\n    var getVarianceDetail = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var response, result, product;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return fetch(\"http://127.0.0.1:8080/api/sale/variances/\".concat(id), {\n                headers: {\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 3:\n              response = _context3.sent;\n              _context3.next = 6;\n              return response.json();\n            case 6:\n              result = _context3.sent;\n              if (result.code === 0) {\n                Object.assign(form, result.data);\n                // 确保商品信息正确显示\n                product = products.value.find(function (p) {\n                  return p.id === form.productId;\n                });\n                if (product) {\n                  form.productName = product.name;\n                  form.unitPrice = product.price;\n                }\n              } else {\n                ElMessage.error(result.message || '获取差异单详情失败');\n              }\n              _context3.next = 14;\n              break;\n            case 10:\n              _context3.prev = 10;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.error('获取差异单详情失败:', _context3.t0);\n              ElMessage.error('获取差异单详情失败');\n            case 14:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 10]]);\n      }));\n      return function getVarianceDetail() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    // 处理订单选择变化\n    var handleOrderChange = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(orderId) {\n        var response, result, order;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return fetch(\"http://127.0.0.1:8080/api/sale/orders/\".concat(orderId), {\n                headers: {\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 3:\n              response = _context4.sent;\n              _context4.next = 6;\n              return response.json();\n            case 6:\n              result = _context4.sent;\n              if (result.code === 0) {\n                order = result.data;\n                form.orderNo = order.orderNo;\n                form.customerId = order.customerId;\n                form.customerName = order.customerName;\n              }\n              _context4.next = 14;\n              break;\n            case 10:\n              _context4.prev = 10;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.error('获取订单详情失败:', _context4.t0);\n              ElMessage.error('获取订单详情失败');\n            case 14:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, null, [[0, 10]]);\n      }));\n      return function handleOrderChange(_x) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    // 处理商品选择变化\n    var handleProductChange = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(productId) {\n        var product, response, result;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              product = products.value.find(function (p) {\n                return p.id === productId;\n              });\n              if (!product) {\n                _context5.next = 19;\n                break;\n              }\n              form.productName = product.name;\n              form.unitPrice = product.price;\n              // 获取订单中该商品的数量\n              if (!form.orderId) {\n                _context5.next = 19;\n                break;\n              }\n              _context5.prev = 5;\n              _context5.next = 8;\n              return fetch(\"http://127.0.0.1:8080/api/sale/orders/\".concat(form.orderId, \"/items?productId=\").concat(productId), {\n                headers: {\n                  'Accept': 'application/json'\n                },\n                credentials: 'include'\n              });\n            case 8:\n              response = _context5.sent;\n              _context5.next = 11;\n              return response.json();\n            case 11:\n              result = _context5.sent;\n              if (result.code === 0) {\n                form.orderQuantity = result.data.quantity || 0;\n                calculateVariance();\n              }\n              _context5.next = 19;\n              break;\n            case 15:\n              _context5.prev = 15;\n              _context5.t0 = _context5[\"catch\"](5);\n              console.error('获取订单商品数量失败:', _context5.t0);\n              ElMessage.error('获取订单商品数量失败');\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, null, [[5, 15]]);\n      }));\n      return function handleProductChange(_x2) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    // 计算差异\n    var calculateVariance = function calculateVariance() {\n      form.varianceQuantity = form.orderQuantity - form.actualQuantity;\n      form.amount = form.varianceQuantity * form.unitPrice;\n      // 根据差异数量自动设置差异类型\n      if (form.varianceQuantity !== 0) {\n        form.type = 'quantity'; // 数量差异\n      } else if (form.amount !== 0) {\n        form.type = 'amount'; // 金额差异\n      } else {\n        form.type = 'other'; // 其他差异\n      }\n    };\n\n    // 提交表单\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              if (formRef.value) {\n                _context7.next = 2;\n                break;\n              }\n              return _context7.abrupt(\"return\");\n            case 2:\n              _context7.next = 4;\n              return formRef.value.validate(/*#__PURE__*/function () {\n                var _ref8 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(valid) {\n                  var url, method, response, result;\n                  return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n                    while (1) switch (_context6.prev = _context6.next) {\n                      case 0:\n                        if (!valid) {\n                          _context6.next = 21;\n                          break;\n                        }\n                        submitting.value = true;\n                        _context6.prev = 2;\n                        url = id ? \"http://127.0.0.1:8080/api/sale/variances/\".concat(id) : 'http://127.0.0.1:8080/api/sale/variances';\n                        method = id ? 'PUT' : 'POST';\n                        _context6.next = 7;\n                        return fetch(url, {\n                          method: method,\n                          headers: {\n                            'Content-Type': 'application/json',\n                            'Accept': 'application/json'\n                          },\n                          credentials: 'include',\n                          body: JSON.stringify(form)\n                        });\n                      case 7:\n                        response = _context6.sent;\n                        _context6.next = 10;\n                        return response.json();\n                      case 10:\n                        result = _context6.sent;\n                        if (result.code === 0) {\n                          ElMessage.success(id ? '更新成功' : '创建成功');\n                          router.back();\n                        } else {\n                          ElMessage.error(result.message || (id ? '更新失败' : '创建失败'));\n                        }\n                        _context6.next = 18;\n                        break;\n                      case 14:\n                        _context6.prev = 14;\n                        _context6.t0 = _context6[\"catch\"](2);\n                        console.error(id ? '更新差异单失败:' : '创建差异单失败:', _context6.t0);\n                        ElMessage.error(id ? '更新失败' : '创建失败');\n                      case 18:\n                        _context6.prev = 18;\n                        submitting.value = false;\n                        return _context6.finish(18);\n                      case 21:\n                      case \"end\":\n                        return _context6.stop();\n                    }\n                  }, _callee6, null, [[2, 14, 18, 21]]);\n                }));\n                return function (_x3) {\n                  return _ref8.apply(this, arguments);\n                };\n              }());\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7);\n      }));\n      return function handleSubmit() {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n\n    // 初始化\n    onMounted(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.next = 2;\n            return Promise.all([getOrders(), getProducts()]);\n          case 2:\n            if (!id) {\n              _context8.next = 5;\n              break;\n            }\n            _context8.next = 5;\n            return getVarianceDetail();\n          case 5:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8);\n    })));\n    var __returned__ = {\n      route: route,\n      router: router,\n      formRef: formRef,\n      submitting: submitting,\n      id: id,\n      mode: mode,\n      isView: isView,\n      formTitle: formTitle,\n      generateVarianceNo: generateVarianceNo,\n      form: form,\n      rules: rules,\n      orders: orders,\n      products: products,\n      getOrders: getOrders,\n      getProducts: getProducts,\n      getVarianceDetail: getVarianceDetail,\n      handleOrderChange: handleOrderChange,\n      handleProductChange: handleProductChange,\n      calculateVariance: calculateVariance,\n      handleSubmit: handleSubmit,\n      ref: ref,\n      reactive: reactive,\n      computed: computed,\n      onMounted: onMounted,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get ElMessage() {\n        return ElMessage;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","computed","onMounted","useRoute","useRouter","ElMessage","route","router","formRef","submitting","id","query","mode","isView","formTitle","value","generateVarianceNo","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","random","Math","floor","toString","concat","form","varianceNo","orderId","orderNo","customerId","customerName","productId","productName","orderQuantity","actualQuantity","varianceQuantity","unitPrice","amount","type","reason","solution","remark","status","rules","required","message","trigger","orders","products","getOrders","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","result","wrap","_callee$","_context","prev","next","fetch","headers","credentials","sent","json","code","data","list","error","t0","console","stop","apply","arguments","getProducts","_ref3","_callee2","_callee2$","_context2","getVarianceDetail","_ref4","_callee3","product","_callee3$","_context3","Object","assign","find","p","name","price","handleOrderChange","_ref5","_callee4","order","_callee4$","_context4","_x","handleProductChange","_ref6","_callee5","_callee5$","_context5","quantity","calculateVariance","_x2","handleSubmit","_ref7","_callee7","_callee7$","_context7","abrupt","validate","_ref8","_callee6","valid","url","method","_callee6$","_context6","body","JSON","stringify","success","back","finish","_x3","_callee8","_callee8$","_context8","Promise","all"],"sources":["C:/Users/indexae/Desktop/scm退货/scm/frontend/src/views/sale/variance/form.vue"],"sourcesContent":["<template>\r\n  <div class=\"variance-form\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>{{ formTitle }}</span>\r\n          <el-button @click=\"$router.back()\">返回</el-button>\r\n        </div>\r\n      </template>\r\n\r\n      <el-form\r\n        ref=\"formRef\"\r\n        :model=\"form\"\r\n        :rules=\"rules\"\r\n        label-width=\"120px\"\r\n        class=\"variance-form\"\r\n      >\r\n        <!-- 基本信息 -->\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"差异单号\" prop=\"varianceNo\">\r\n              <el-input v-model=\"form.varianceNo\" disabled />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"关联订单号\" prop=\"orderId\">\r\n              <el-select\r\n                v-model=\"form.orderId\"\r\n                placeholder=\"请选择关联订单\"\r\n                :disabled=\"isView || !!id\"\r\n                @change=\"handleOrderChange\"\r\n              >\r\n                <el-option\r\n                  v-for=\"order in orders\"\r\n                  :key=\"order.id\"\r\n                  :label=\"order.orderNo\"\r\n                  :value=\"order.id\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"客户名称\" prop=\"customerName\">\r\n              <el-input v-model=\"form.customerName\" disabled />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"商品名称\" prop=\"productId\">\r\n              <el-select\r\n                v-model=\"form.productId\"\r\n                placeholder=\"请选择商品\"\r\n                :disabled=\"isView || !!id\"\r\n                @change=\"handleProductChange\"\r\n              >\r\n                <el-option\r\n                  v-for=\"product in products\"\r\n                  :key=\"product.id\"\r\n                  :label=\"product.name\"\r\n                  :value=\"product.id\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"订单数量\" prop=\"orderQuantity\">\r\n              <el-input-number\r\n                v-model=\"form.orderQuantity\"\r\n                :min=\"0\"\r\n                :disabled=\"true\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"实际数量\" prop=\"actualQuantity\">\r\n              <el-input-number\r\n                v-model=\"form.actualQuantity\"\r\n                :min=\"0\"\r\n                :disabled=\"isView\"\r\n                @change=\"calculateVariance\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"差异数量\" prop=\"varianceQuantity\">\r\n              <el-input-number\r\n                v-model=\"form.varianceQuantity\"\r\n                :disabled=\"true\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"单价\" prop=\"unitPrice\">\r\n              <el-input-number\r\n                v-model=\"form.unitPrice\"\r\n                :precision=\"2\"\r\n                :disabled=\"true\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"差异金额\" prop=\"amount\">\r\n              <el-input-number\r\n                v-model=\"form.amount\"\r\n                :precision=\"2\"\r\n                :disabled=\"true\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item label=\"差异原因\" prop=\"reason\">\r\n          <el-input\r\n            v-model=\"form.reason\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"请输入差异原因\"\r\n            :disabled=\"isView\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"处理方案\" prop=\"solution\">\r\n          <el-input\r\n            v-model=\"form.solution\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"请输入处理方案\"\r\n            :disabled=\"isView || form.status !== 'pending'\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"备注\" prop=\"remark\">\r\n          <el-input\r\n            v-model=\"form.remark\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"请输入备注信息\"\r\n            :disabled=\"isView\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button\r\n            v-if=\"!isView\"\r\n            type=\"primary\"\r\n            @click=\"handleSubmit\"\r\n            :loading=\"submitting\"\r\n          >\r\n            保存\r\n          </el-button>\r\n          <el-button @click=\"$router.back()\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst formRef = ref(null)\r\nconst submitting = ref(false)\r\n\r\n// 获取路由参数\r\nconst id = route.query.id\r\nconst mode = route.query.mode\r\nconst isView = computed(() => mode === 'view')\r\n\r\n// 表单标题\r\nconst formTitle = computed(() => {\r\n  if (isView.value) return '查看销售差异'\r\n  return id ? '编辑销售差异' : '新增销售差异'\r\n})\r\n\r\n// 生成差异单号\r\nconst generateVarianceNo = () => {\r\n  const date = new Date()\r\n  const year = date.getFullYear()\r\n  const month = String(date.getMonth() + 1).padStart(2, '0')\r\n  const day = String(date.getDate()).padStart(2, '0')\r\n  const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0')\r\n  return `CY${year}${month}${day}${random}`\r\n}\r\n\r\n// 表单数据\r\nconst form = reactive({\r\n  varianceNo: generateVarianceNo(),  // 初始化时生成差异单号\r\n  orderId: '',\r\n  orderNo: '',\r\n  customerId: '',\r\n  customerName: '',\r\n  productId: '',\r\n  productName: '',\r\n  orderQuantity: 0,\r\n  actualQuantity: 0,\r\n  varianceQuantity: 0,\r\n  unitPrice: 0,\r\n  amount: 0,\r\n  type: 'quantity',\r\n  reason: '',\r\n  solution: '',\r\n  remark: '',\r\n  status: 'pending'\r\n})\r\n\r\n// 表单验证规则\r\nconst rules = {\r\n  orderId: [{ required: true, message: '请选择关联订单', trigger: 'change' }],\r\n  productId: [{ required: true, message: '请选择商品', trigger: 'change' }],\r\n  actualQuantity: [{ required: true, message: '请输入实际数量', trigger: 'blur' }],\r\n  reason: [{ required: true, message: '请输入差异原因', trigger: 'blur' }]\r\n}\r\n\r\n// 订单列表\r\nconst orders = ref([])\r\n// 商品列表\r\nconst products = ref([])\r\n\r\n// 获取订单列表\r\nconst getOrders = async () => {\r\n  try {\r\n    const response = await fetch('http://127.0.0.1:8080/api/sale/orders?status=completed', {\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include'\r\n    })\r\n    const result = await response.json()\r\n    if (result.code === 0) {\r\n      orders.value = result.data.list || []\r\n    } else {\r\n      ElMessage.error(result.message || '获取订单列表失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取订单列表失败:', error)\r\n    ElMessage.error('获取订单列表失败')\r\n  }\r\n}\r\n\r\n// 获取商品列表\r\nconst getProducts = async () => {\r\n  try {\r\n    const response = await fetch('http://127.0.0.1:8080/api/products', {\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include'\r\n    })\r\n    const result = await response.json()\r\n    if (result.code === 0) {\r\n      products.value = result.data.list || []\r\n    } else {\r\n      ElMessage.error(result.message || '获取商品列表失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取商品列表失败:', error)\r\n    ElMessage.error('获取商品列表失败')\r\n  }\r\n}\r\n\r\n// 获取差异单详情\r\nconst getVarianceDetail = async () => {\r\n  try {\r\n    const response = await fetch(`http://127.0.0.1:8080/api/sale/variances/${id}`, {\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include'\r\n    })\r\n    const result = await response.json()\r\n    if (result.code === 0) {\r\n      Object.assign(form, result.data)\r\n      // 确保商品信息正确显示\r\n      const product = products.value.find(p => p.id === form.productId)\r\n      if (product) {\r\n        form.productName = product.name\r\n        form.unitPrice = product.price\r\n      }\r\n    } else {\r\n      ElMessage.error(result.message || '获取差异单详情失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取差异单详情失败:', error)\r\n    ElMessage.error('获取差异单详情失败')\r\n  }\r\n}\r\n\r\n// 处理订单选择变化\r\nconst handleOrderChange = async (orderId) => {\r\n  try {\r\n    const response = await fetch(`http://127.0.0.1:8080/api/sale/orders/${orderId}`, {\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      },\r\n      credentials: 'include'\r\n    })\r\n    const result = await response.json()\r\n    if (result.code === 0) {\r\n      const order = result.data\r\n      form.orderNo = order.orderNo\r\n      form.customerId = order.customerId\r\n      form.customerName = order.customerName\r\n    }\r\n  } catch (error) {\r\n    console.error('获取订单详情失败:', error)\r\n    ElMessage.error('获取订单详情失败')\r\n  }\r\n}\r\n\r\n// 处理商品选择变化\r\nconst handleProductChange = async (productId) => {\r\n  const product = products.value.find(p => p.id === productId)\r\n  if (product) {\r\n    form.productName = product.name\r\n    form.unitPrice = product.price\r\n    // 获取订单中该商品的数量\r\n    if (form.orderId) {\r\n      try {\r\n        const response = await fetch(`http://127.0.0.1:8080/api/sale/orders/${form.orderId}/items?productId=${productId}`, {\r\n          headers: {\r\n            'Accept': 'application/json'\r\n          },\r\n          credentials: 'include'\r\n        })\r\n        const result = await response.json()\r\n        if (result.code === 0) {\r\n          form.orderQuantity = result.data.quantity || 0\r\n          calculateVariance()\r\n        }\r\n      } catch (error) {\r\n        console.error('获取订单商品数量失败:', error)\r\n        ElMessage.error('获取订单商品数量失败')\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 计算差异\r\nconst calculateVariance = () => {\r\n  form.varianceQuantity = form.orderQuantity - form.actualQuantity\r\n  form.amount = form.varianceQuantity * form.unitPrice\r\n  // 根据差异数量自动设置差异类型\r\n  if (form.varianceQuantity !== 0) {\r\n    form.type = 'quantity'  // 数量差异\r\n  } else if (form.amount !== 0) {\r\n    form.type = 'amount'   // 金额差异\r\n  } else {\r\n    form.type = 'other'    // 其他差异\r\n  }\r\n}\r\n\r\n// 提交表单\r\nconst handleSubmit = async () => {\r\n  if (!formRef.value) return\r\n  \r\n  await formRef.value.validate(async (valid) => {\r\n    if (valid) {\r\n      submitting.value = true\r\n      try {\r\n        const url = id\r\n          ? `http://127.0.0.1:8080/api/sale/variances/${id}`\r\n          : 'http://127.0.0.1:8080/api/sale/variances'\r\n        const method = id ? 'PUT' : 'POST'\r\n        \r\n        const response = await fetch(url, {\r\n          method,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json'\r\n          },\r\n          credentials: 'include',\r\n          body: JSON.stringify(form)\r\n        })\r\n        \r\n        const result = await response.json()\r\n        if (result.code === 0) {\r\n          ElMessage.success(id ? '更新成功' : '创建成功')\r\n          router.back()\r\n        } else {\r\n          ElMessage.error(result.message || (id ? '更新失败' : '创建失败'))\r\n        }\r\n      } catch (error) {\r\n        console.error(id ? '更新差异单失败:' : '创建差异单失败:', error)\r\n        ElMessage.error(id ? '更新失败' : '创建失败')\r\n      } finally {\r\n        submitting.value = false\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 初始化\r\nonMounted(async () => {\r\n  await Promise.all([getOrders(), getProducts()])\r\n  if (id) {\r\n    await getVarianceDetail()\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.variance-form {\r\n  height: 100%;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.el-form {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}