{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"login-log\"\n};\nvar _hoisted_2 = {\n  \"class\": \"card-header\"\n};\nvar _hoisted_3 = {\n  \"class\": \"header-right\"\n};\nvar _hoisted_4 = {\n  \"class\": \"pagination\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_table_column = _resolveComponent(\"el-table-column\");\n  var _component_el_tag = _resolveComponent(\"el-tag\");\n  var _component_el_table = _resolveComponent(\"el-table\");\n  var _component_el_pagination = _resolveComponent(\"el-pagination\");\n  var _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    \"class\": \"box-card\"\n  }, {\n    header: _withCtx(function () {\n      return [_createElementVNode(\"div\", _hoisted_2, [_cache[4] || (_cache[4] = _createElementVNode(\"span\", null, \"登录日志\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_date_picker, {\n        modelValue: $setup.dateRange,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.dateRange = $event;\n        }),\n        type: \"daterange\",\n        \"range-separator\": \"至\",\n        \"start-placeholder\": \"开始日期\",\n        \"end-placeholder\": \"结束日期\",\n        shortcuts: $setup.shortcuts,\n        \"value-format\": \"YYYY-MM-DD\",\n        onChange: $setup.handleDateChange\n      }, null, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: $setup.fetchLogs\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[3] || (_cache[3] = [_createTextVNode(\"查询\")]);\n        }),\n        _: 1 /* STABLE */\n      })])])];\n    }),\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_el_table, {\n        data: $setup.logs,\n        style: {\n          \"width\": \"100%\"\n        }\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_table_column, {\n            prop: \"id\",\n            label: \"ID\",\n            width: \"80\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"username\",\n            label: \"用户名\",\n            width: \"120\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"ip\",\n            label: \"IP地址\",\n            width: \"120\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"status\",\n            label: \"状态\",\n            width: \"100\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createVNode(_component_el_tag, {\n                type: scope.row.status ? 'success' : 'danger'\n              }, {\n                \"default\": _withCtx(function () {\n                  return [_createTextVNode(_toDisplayString(scope.row.status ? '成功' : '失败'), 1 /* TEXT */)];\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"type\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_table_column, {\n            prop: \"browser\",\n            label: \"浏览器\",\n            width: \"150\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"os\",\n            label: \"操作系统\",\n            width: \"150\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"loginTime\",\n            label: \"登录时间\"\n          })];\n        }),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"data\"]), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_pagination, {\n        \"current-page\": $setup.currentPage,\n        \"onUpdate:currentPage\": _cache[1] || (_cache[1] = function ($event) {\n          return $setup.currentPage = $event;\n        }),\n        \"page-size\": $setup.pageSize,\n        \"onUpdate:pageSize\": _cache[2] || (_cache[2] = function ($event) {\n          return $setup.pageSize = $event;\n        }),\n        \"page-sizes\": [10, 20, 50, 100],\n        layout: \"total, sizes, prev, pager, next, jumper\",\n        total: $setup.total,\n        onSizeChange: $setup.handleSizeChange,\n        onCurrentChange: $setup.handleCurrentChange\n      }, null, 8 /* PROPS */, [\"current-page\", \"page-size\", \"total\"])])];\n    }),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createVNode","_component_el_card","header","_withCtx","_createElementVNode","_hoisted_2","_hoisted_3","_component_el_date_picker","modelValue","$setup","dateRange","_cache","$event","type","shortcuts","onChange","handleDateChange","_component_el_button","onClick","fetchLogs","_createTextVNode","_","_component_el_table","data","logs","style","_component_el_table_column","prop","label","width","scope","_component_el_tag","row","status","_toDisplayString","_hoisted_4","_component_el_pagination","currentPage","pageSize","layout","total","onSizeChange","handleSizeChange","onCurrentChange","handleCurrentChange"],"sources":["C:\\Users\\indexae\\Desktop\\scm\\scm\\frontend\\src\\views\\LoginLog.vue"],"sourcesContent":["<template>\n  <div class=\"login-log\">\n    <el-card class=\"box-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>登录日志</span>\n          <div class=\"header-right\">\n            <el-date-picker\n              v-model=\"dateRange\"\n              type=\"daterange\"\n              range-separator=\"至\"\n              start-placeholder=\"开始日期\"\n              end-placeholder=\"结束日期\"\n              :shortcuts=\"shortcuts\"\n              value-format=\"YYYY-MM-DD\"\n              @change=\"handleDateChange\"\n            />\n            <el-button type=\"primary\" @click=\"fetchLogs\">查询</el-button>\n          </div>\n        </div>\n      </template>\n      \n      <!-- 日志列表 -->\n      <el-table :data=\"logs\" style=\"width: 100%\">\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"120\" />\n        <el-table-column prop=\"ip\" label=\"IP地址\" width=\"120\" />\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <template #default=\"scope\">\n            <el-tag :type=\"scope.row.status ? 'success' : 'danger'\">\n              {{ scope.row.status ? '成功' : '失败' }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"browser\" label=\"浏览器\" width=\"150\" />\n        <el-table-column prop=\"os\" label=\"操作系统\" width=\"150\" />\n        <el-table-column prop=\"loginTime\" label=\"登录时间\" />\n      </el-table>\n      \n      <!-- 分页 -->\n      <div class=\"pagination\">\n        <el-pagination\n          v-model:current-page=\"currentPage\"\n          v-model:page-size=\"pageSize\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\n\n// 日期快捷选项\nconst shortcuts = [\n  {\n    text: '最近一周',\n    value: () => {\n      const end = new Date()\n      const start = new Date()\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\n      return [start, end]\n    },\n  },\n  {\n    text: '最近一个月',\n    value: () => {\n      const end = new Date()\n      const start = new Date()\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\n      return [start, end]\n    },\n  },\n  {\n    text: '最近三个月',\n    value: () => {\n      const end = new Date()\n      const start = new Date()\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\n      return [start, end]\n    },\n  },\n]\n\n// 响应式数据\nconst logs = ref([])\nconst dateRange = ref([])\nconst currentPage = ref(1)\nconst pageSize = ref(10)\nconst total = ref(0)\n\n// 获取日志列表\nconst fetchLogs = async () => {\n  try {\n    const params = new URLSearchParams({\n      page: currentPage.value,\n      size: pageSize.value,\n    })\n    \n    if (dateRange.value && dateRange.value.length === 2) {\n      params.append('startDate', dateRange.value[0])\n      params.append('endDate', dateRange.value[1])\n    }\n    \n    const res = await fetch(`http://localhost:8000/api/logs/login?${params}`, {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: 'include'\n    })\n    \n    const data = await res.json()\n    if (data.code === 0) {\n      logs.value = data.data.records\n      total.value = data.data.total\n    } else {\n      ElMessage.error(data.message || '获取日志失败')\n    }\n  } catch (error) {\n    console.error('获取日志失败:', error)\n    ElMessage.error('获取日志失败')\n  }\n}\n\n// 处理日期变化\nconst handleDateChange = () => {\n  currentPage.value = 1\n  fetchLogs()\n}\n\n// 处理每页数量变化\nconst handleSizeChange = (val) => {\n  pageSize.value = val\n  fetchLogs()\n}\n\n// 处理页码变化\nconst handleCurrentChange = (val) => {\n  currentPage.value = val\n  fetchLogs()\n}\n\nonMounted(() => {\n  fetchLogs()\n})\n</script>\n\n<style scoped>\n.login-log {\n  padding: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.header-right {\n  display: flex;\n  gap: 10px;\n}\n\n.pagination {\n  margin-top: 20px;\n  display: flex;\n  justify-content: flex-end;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}