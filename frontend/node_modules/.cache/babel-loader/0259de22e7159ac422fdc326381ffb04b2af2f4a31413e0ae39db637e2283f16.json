{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"login-container\"\n};\nvar _hoisted_2 = {\n  \"class\": \"login-box\"\n};\nvar _hoisted_3 = {\n  \"class\": \"form-item\"\n};\nvar _hoisted_4 = {\n  \"class\": \"form-item\"\n};\nvar _hoisted_5 = {\n  \"class\": \"form-item\"\n};\nvar _hoisted_6 = {\n  \"class\": \"form-item\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_input = _resolveComponent(\"el-input\");\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_router_link = _resolveComponent(\"router-link\");\n  var _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"供应链管理平台\", -1 /* HOISTED */)), _createVNode(_component_el_form, {\n    ref: \"loginFormRef\",\n    model: $setup.loginForm\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_input, {\n        modelValue: $setup.loginForm.username,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.loginForm.username = $event;\n        }),\n        placeholder: \"用户名\",\n        required: \"\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_input, {\n        modelValue: $setup.loginForm.password,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n          return $setup.loginForm.password = $event;\n        }),\n        type: \"password\",\n        placeholder: \"密码\",\n        required: \"\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: $setup.handleLogin,\n        style: {\n          \"width\": \"100%\"\n        }\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[2] || (_cache[2] = [_createTextVNode(\"登录\")]);\n        }),\n        _: 1 /* STABLE */\n      })]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_router_link, {\n        to: \"/register\",\n        \"class\": \"register-link\"\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[3] || (_cache[3] = [_createTextVNode(\"没有账号？去注册\")]);\n        }),\n        _: 1 /* STABLE */\n      })])];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\"])])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_form","ref","model","$setup","loginForm","_withCtx","_hoisted_3","_component_el_input","modelValue","username","_cache","$event","placeholder","required","_hoisted_4","password","type","_hoisted_5","_component_el_button","onClick","handleLogin","style","_createTextVNode","_","_hoisted_6","_component_router_link","to"],"sources":["C:\\Users\\indexae\\Desktop\\scm退货\\scm\\frontend\\src\\views\\Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <div class=\"login-box\">\n      <h2>供应链管理平台</h2>\n      <el-form ref=\"loginFormRef\" :model=\"loginForm\">\n        <div class=\"form-item\">\n          <el-input\n            v-model=\"loginForm.username\"\n            placeholder=\"用户名\"\n            required\n          />\n        </div>\n        <div class=\"form-item\">\n          <el-input\n            v-model=\"loginForm.password\"\n            type=\"password\"\n            placeholder=\"密码\"\n            required\n          />\n        </div>\n        <div class=\"form-item\">\n          <el-button type=\"primary\" @click=\"handleLogin\" style=\"width: 100%\">登录</el-button>\n        </div>\n        <div class=\"form-item\">\n          <router-link to=\"/register\" class=\"register-link\">没有账号？去注册</router-link>\n        </div>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { reactive, ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\n\nconst router = useRouter()\nconst loginFormRef = ref(null)\n\nconst loginForm = reactive({\n  username: '',\n  password: ''\n})\n\nconst handleLogin = async () => {\n  try {\n    const res = await fetch('http://localhost:8080/api/login', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(loginForm)\n    })\n    \n    const data = await res.json()\n    if (data.code === 0) {\n      // 存储用户信息\n      localStorage.setItem('userId', data.data.id)\n      localStorage.setItem('username', data.data.username)\n      \n      // 获取用户角色信息\n      const rolesRes = await fetch(`http://localhost:8080/api/roles/user/${data.data.id}`, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n      const rolesData = await rolesRes.json()\n      \n      if (rolesData.code === 0) {\n        // 存储用户角色信息\n        const roles = rolesData.data.map(role => role.roleName)\n        localStorage.setItem('userRoles', JSON.stringify(roles))\n      }\n      \n      ElMessage.success('登录成功')\n      router.push('/dashboard')\n    } else {\n      ElMessage.error(data.message || '登录失败')\n    }\n  } catch (error) {\n    console.error('登录失败:', error)\n    ElMessage.error('登录失败')\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f5f5f5;\n}\n\n.login-box {\n  width: 400px;\n  padding: 40px;\n  background: white;\n  border-radius: 4px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.login-box h2 {\n  text-align: center;\n  margin-bottom: 30px;\n}\n\n.form-item {\n  margin-bottom: 20px;\n}\n\n.form-item .el-input {\n  width: 100%;\n}\n\n.register-link {\n  display: block;\n  text-align: center;\n  color: #409eff;\n  text-decoration: none;\n}\n\n.register-link:hover {\n  color: #66b1ff;\n}\n</style> "],"mappings":";;EACO,SAAM;AAAiB;;EACrB,SAAM;AAAW;;EAGb,SAAM;AAAW;;EAOjB,SAAM;AAAW;;EAQjB,SAAM;AAAW;;EAGjB,SAAM;AAAW;;;;;;uBAtB5BA,mBAAA,CA2BM,OA3BNC,UA2BM,GA1BJC,mBAAA,CAyBM,OAzBNC,UAyBM,G,0BAxBJD,mBAAA,CAAgB,YAAZ,SAAO,sBACXE,YAAA,CAsBUC,kBAAA;IAtBDC,GAAG,EAAC,cAAc;IAAEC,KAAK,EAAEC,MAAA,CAAAC;;IAJ1C,WAAAC,QAAA,CAKQ;MAAA,OAMM,CANNR,mBAAA,CAMM,OANNS,UAMM,GALJP,YAAA,CAIEQ,mBAAA;QAVZC,UAAA,EAOqBL,MAAA,CAAAC,SAAS,CAACK,QAAQ;QAPvC,uBAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAOqBR,MAAA,CAAAC,SAAS,CAACK,QAAQ,GAAAE,MAAA;QAAA;QAC3BC,WAAW,EAAC,KAAK;QACjBC,QAAQ,EAAR;iDAGJhB,mBAAA,CAOM,OAPNiB,UAOM,GANJf,YAAA,CAKEQ,mBAAA;QAlBZC,UAAA,EAcqBL,MAAA,CAAAC,SAAS,CAACW,QAAQ;QAdvC,uBAAAL,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAcqBR,MAAA,CAAAC,SAAS,CAACW,QAAQ,GAAAJ,MAAA;QAAA;QAC3BK,IAAI,EAAC,UAAU;QACfJ,WAAW,EAAC,IAAI;QAChBC,QAAQ,EAAR;iDAGJhB,mBAAA,CAEM,OAFNoB,UAEM,GADJlB,YAAA,CAAiFmB,oBAAA;QAAtEF,IAAI,EAAC,SAAS;QAAEG,OAAK,EAAEhB,MAAA,CAAAiB,WAAW;QAAEC,KAAmB,EAAnB;UAAA;QAAA;;QArBzD,WAAAhB,QAAA,CAqB6E;UAAA,OAAEK,MAAA,QAAAA,MAAA,OArB/EY,gBAAA,CAqB6E,IAAE,E;;QArB/EC,CAAA;YAuBQ1B,mBAAA,CAEM,OAFN2B,UAEM,GADJzB,YAAA,CAAwE0B,sBAAA;QAA3DC,EAAE,EAAC,WAAW;QAAC,SAAM;;QAxB5C,WAAArB,QAAA,CAwB4D;UAAA,OAAQK,MAAA,QAAAA,MAAA,OAxBpEY,gBAAA,CAwB4D,UAAQ,E;;QAxBpEC,CAAA;;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}