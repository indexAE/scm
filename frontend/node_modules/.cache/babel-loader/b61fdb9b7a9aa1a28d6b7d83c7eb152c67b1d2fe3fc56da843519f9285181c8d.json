{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/indexae/Desktop/scm/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/indexae/Desktop/scm/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport { ref, onMounted } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport axios from 'axios';\nexport default {\n  __name: 'LoginLog',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var logs = ref([]);\n    var total = ref(0);\n    var currentPage = ref(1);\n    var pageSize = ref(10);\n    var dateRange = ref([]);\n    var fetchLogs = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _dateRange$value, _dateRange$value2, startDate, endDate, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              startDate = ((_dateRange$value = dateRange.value) === null || _dateRange$value === void 0 ? void 0 : _dateRange$value[0]) || '';\n              endDate = ((_dateRange$value2 = dateRange.value) === null || _dateRange$value2 === void 0 ? void 0 : _dateRange$value2[1]) || '';\n              _context.next = 5;\n              return axios.get('/api/logs/login', {\n                params: {\n                  startDate: startDate,\n                  endDate: endDate,\n                  page: currentPage.value,\n                  size: pageSize.value\n                }\n              });\n            case 5:\n              response = _context.sent;\n              if (response.data.code === 0) {\n                logs.value = response.data.data.logs;\n                total.value = response.data.data.total;\n              } else {\n                ElMessage.error(response.data.message || '获取登录日志失败');\n              }\n              _context.next = 13;\n              break;\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('获取登录日志失败:', _context.t0);\n              ElMessage.error('获取登录日志失败');\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 9]]);\n      }));\n      return function fetchLogs() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var handleSizeChange = function handleSizeChange(val) {\n      pageSize.value = val;\n      fetchLogs();\n    };\n    var handleCurrentChange = function handleCurrentChange(val) {\n      currentPage.value = val;\n      fetchLogs();\n    };\n    var handleDateChange = function handleDateChange() {\n      currentPage.value = 1;\n      fetchLogs();\n    };\n    onMounted(function () {\n      fetchLogs();\n    });\n    var __returned__ = {\n      logs: logs,\n      total: total,\n      currentPage: currentPage,\n      pageSize: pageSize,\n      dateRange: dateRange,\n      fetchLogs: fetchLogs,\n      handleSizeChange: handleSizeChange,\n      handleCurrentChange: handleCurrentChange,\n      handleDateChange: handleDateChange,\n      ref: ref,\n      onMounted: onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","ElMessage","axios","logs","total","currentPage","pageSize","dateRange","fetchLogs","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_dateRange$value","_dateRange$value2","startDate","endDate","response","wrap","_callee$","_context","prev","next","value","get","params","page","size","sent","data","code","error","message","t0","console","stop","apply","arguments","handleSizeChange","val","handleCurrentChange","handleDateChange"],"sources":["C:/Users/indexae/Desktop/scm/frontend/src/components/LoginLog.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-log\">\r\n    <div class=\"header\">\r\n      <el-date-picker\r\n        v-model=\"dateRange\"\r\n        type=\"daterange\"\r\n        range-separator=\"至\"\r\n        start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\"\r\n        value-format=\"YYYY-MM-DD\"\r\n        @change=\"handleDateChange\"\r\n      />\r\n      <el-button type=\"primary\" @click=\"fetchLogs\">查询</el-button>\r\n    </div>\r\n    \r\n    <el-table :data=\"logs\" border style=\"width: 100%; margin-top: 20px;\">\r\n      <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n      <el-table-column prop=\"username\" label=\"用户名\" width=\"120\" />\r\n      <el-table-column prop=\"ip\" label=\"IP地址\" width=\"140\" />\r\n      <el-table-column prop=\"browser\" label=\"浏览器\" width=\"100\" />\r\n      <el-table-column prop=\"os\" label=\"操作系统\" width=\"100\" />\r\n      <el-table-column prop=\"status\" label=\"状态\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag :type=\"scope.row.status ? 'success' : 'danger'\">\r\n            {{ scope.row.status ? '成功' : '失败' }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"message\" label=\"消息\" />\r\n      <el-table-column prop=\"loginTime\" label=\"登录时间\" width=\"180\" />\r\n    </el-table>\r\n    \r\n    <div class=\"pagination\" style=\"margin-top: 20px; text-align: right;\">\r\n      <el-pagination\r\n        v-model:current-page=\"currentPage\"\r\n        v-model:page-size=\"pageSize\"\r\n        :total=\"total\"\r\n        :page-sizes=\"[10, 20, 50, 100]\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport axios from 'axios'\r\n\r\nconst logs = ref([])\r\nconst total = ref(0)\r\nconst currentPage = ref(1)\r\nconst pageSize = ref(10)\r\nconst dateRange = ref([])\r\n\r\nconst fetchLogs = async () => {\r\n  try {\r\n    const startDate = dateRange.value?.[0] || ''\r\n    const endDate = dateRange.value?.[1] || ''\r\n    const response = await axios.get('/api/logs/login', {\r\n      params: {\r\n        startDate,\r\n        endDate,\r\n        page: currentPage.value,\r\n        size: pageSize.value\r\n      }\r\n    })\r\n    if (response.data.code === 0) {\r\n      logs.value = response.data.data.logs\r\n      total.value = response.data.data.total\r\n    } else {\r\n      ElMessage.error(response.data.message || '获取登录日志失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取登录日志失败:', error)\r\n    ElMessage.error('获取登录日志失败')\r\n  }\r\n}\r\n\r\nconst handleSizeChange = (val) => {\r\n  pageSize.value = val\r\n  fetchLogs()\r\n}\r\n\r\nconst handleCurrentChange = (val) => {\r\n  currentPage.value = val\r\n  fetchLogs()\r\n}\r\n\r\nconst handleDateChange = () => {\r\n  currentPage.value = 1\r\n  fetchLogs()\r\n}\r\n\r\nonMounted(() => {\r\n  fetchLogs()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.login-log {\r\n  padding: 20px;\r\n}\r\n\r\n.header {\r\n  display: flex;\r\n  gap: 20px;\r\n  align-items: center;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}